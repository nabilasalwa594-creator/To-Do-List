<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Planner To-Do List Akuu</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<style>
  :root{
    --bg1: #fff8ff; /* cream */
    --accent1: #ffd7eb; /* pink */
    --accent2: #e7e0ff; /* lavender */
    --accent3: #d7f0ff; /* blue */
    --card: rgba(255,255,255,0.9);
    --text: #2b2b2b;
    --muted: #6b6b6b;
    --radius: 14px;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
    background: linear-gradient(135deg,var(--bg1), #f3f9ff 60%);
    color:var(--text);
    display:flex;
    justify-content:center;
    padding:28px;
  }

  .wrap{
    width:100%;
    max-width:1100px;
    background:var(--card);
    border-radius:20px;
    padding:22px;
    box-shadow:0 18px 50px rgba(60,50,90,0.08);
    border:1px solid rgba(255,255,255,0.6);
  }

  header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
    flex-wrap:wrap;
    margin-bottom:14px;
  }
  .title{
    display:flex;
    gap:12px;
    align-items:end;
  }
  h1{margin:0;font-size:20px;font-weight:600;color:#4b2fa8}
  .sub{font-size:13px;color:var(--muted);margin-top:2px}

  /* layout grid: left calendar, right tasks/notes */
  .grid{
    display:grid;
    grid-template-columns: 1fr 420px;
    gap:20px;
  }
  @media(max-width:980px){
    .grid{grid-template-columns:1fr}
  }

  /* calendar card */
  .cal-card{
    background: linear-gradient(135deg,var(--accent1), var(--accent2));
    padding:16px;
    border-radius:var(--radius);
    box-shadow: 0 10px 30px rgba(86,64,186,0.06);
    border:1px solid rgba(255,255,255,0.6);
  }
  .cal-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:12px;
    gap:8px;
  }
  .cal-header .month{
    font-weight:600;
    font-size:18px;
    color:#3a2b7a;
  }
  .nav-btn{
    background:transparent;
    border:none;
    padding:8px 10px;
    border-radius:10px;
    cursor:pointer;
    font-weight:600;
    color:#3a2b7a;
  }
  .nav-btn:hover{background:rgba(255,255,255,0.2)}

  .weekdays{
    display:grid;
    grid-template-columns:repeat(7,1fr);
    gap:8px;
    margin-bottom:8px;
  }
  .weekday{
    text-align:center;
    font-size:12px;
    color:#3a2b7a;
    font-weight:600;
  }

  .days{
    display:grid;
    grid-template-columns:repeat(7,1fr);
    gap:8px;
  }
  .day{
    padding:12px 8px;
    min-height:56px;
    background:rgba(255,255,255,0.9);
    border-radius:10px;
    text-align:center;
    font-weight:600;
    color:#4a3a86;
    cursor:pointer;
    position:relative;
    transition:transform .14s ease, box-shadow .14s ease;
  }
  .day:hover{ transform: translateY(-4px); box-shadow:0 8px 20px rgba(75,45,150,0.08) }
  .day.empty{background:transparent;box-shadow:none;cursor:default}
  .day.selected{
    background: linear-gradient(180deg,var(--accent3), #cfefff);
    color:#05375a;
    box-shadow:0 12px 30px rgba(27,112,153,0.12);
    transform:none;
  }
  .day .date-num{ display:block; font-size:14px }
  .day .dot{
    width:8px;height:8px;border-radius:12px;background:#ff87c1;margin:8px auto 0;opacity:0.9;
  }

  /* Right column - tasks & notes */
  .panel{
    background:linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.95));
    padding:16px;
    border-radius:var(--radius);
    border:1px solid rgba(230,225,255,0.7);
    box-shadow:0 8px 24px rgba(70,50,120,0.04);
  }
  .panel h3{margin:0 0 8px 0;font-size:16px;color:#4b2fa8}
  .selected-info{font-size:13px;color:var(--muted);margin-bottom:10px}

  /* add task */
  .add-row{display:flex;gap:8px;margin-bottom:12px}
  .add-row input[type="text"]{
    flex:1;padding:10px;border-radius:10px;border:1px solid rgba(200,190,255,0.7)
  }
  .add-row button{
    background:linear-gradient(180deg,#bfa7ff,#b093ff);border:none;color:white;padding:10px 12px;border-radius:10px;cursor:pointer;font-weight:600;
  }

  .tasks-list{max-height:320px;overflow:auto;padding-right:6px}
  .task-item{
    display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;margin-bottom:10px;background:linear-gradient(180deg,#fff,#fbfbff);
    border:1px solid rgba(230,225,255,0.7);
  }
  .task-item .text{flex:1;outline:none}
  .task-item.completed{opacity:0.75;text-decoration:line-through;background:linear-gradient(180deg,#f0eaff,#efe9ff)}

  .task-actions{display:flex;gap:8px;align-items:center}
  .icon-btn{background:transparent;border:none;cursor:pointer;padding:6px;border-radius:8px}
  .icon-btn:hover{background:rgba(0,0,0,0.05)}
  .delete-btn{color:#b83a6c}

  /* notes */
  .notes{margin-top:12px}
  .notes textarea{width:100%;min-height:110px;padding:10px;border-radius:10px;border:1px solid rgba(200,190,255,0.7);resize:vertical;font-size:14px}

  /* footer small */
  .hint{font-size:12px;color:var(--muted);margin-top:10px;text-align:center}

  /* medal popup */
  #medal-popup{
    position:fixed;left:50%;top:50%;transform:translate(-50%,-50%) scale(0.6);
    background:linear-gradient(135deg,#fff0fb,#eaf6ff);padding:28px;border-radius:18px;
    box-shadow:0 20px 50px rgba(45,30,90,0.16);display:none;z-index:9999;border:3px solid white;text-align:center;
  }
  #medal-popup .medal{font-size:72px;margin-bottom:8px}
  #medal-popup h2{margin:6px 0 4px 0;color:#3a2b7a}
  #medal-popup p{margin:0;color:var(--muted)}
  #medal-popup button{margin-top:12px;padding:8px 14px;border-radius:10px;border:none;background:linear-gradient(180deg,#bfa7ff,#b093ff);color:white;cursor:pointer}

  /* confetti simple */
  .confetti-piece{
    position:fixed;pointer-events:none;z-index:11000;will-change:transform,opacity;
  }

  /* scrollbar tiny */
  ::-webkit-scrollbar{width:8px;height:8px}
  ::-webkit-scrollbar-thumb{background:rgba(140,120,255,0.25);border-radius:20px}
</style>
</head>
<body>
  <div class="wrap" role="application">
    <header>
      <div class="title">
        <div>
          <h1 contenteditable="true">My Planner To-Do List</h1>
          <div class="sub">Haii!! Selalu Semangatt Memulai Hari Kamuu Yaa</div>
        </div>
      </div>
      <div class="controls" style="display:flex;gap:8px;align-items:center">
        <div style="font-size:13px;color:var(--muted)"></div>
      </div>
    </header>

    <main class="grid">
      <!-- LEFT: Calendar -->
      <section class="cal-card" aria-label="calendar">
        <div class="cal-header">
          <button id="prevMonth" class="nav-btn" aria-label="previous month">‚óÄ</button>
          <div class="month" id="monthLabel">Bulan Tahun</div>
          <button id="nextMonth" class="nav-btn" aria-label="next month">‚ñ∂</button>
        </div>

        <div class="weekdays" aria-hidden="true">
          <div class="weekday">Min</div><div class="weekday">Sen</div><div class="weekday">Sel</div><div class="weekday">Rab</div><div class="weekday">Kam</div><div class="weekday">Jum</div><div class="weekday">Sab</div>
        </div>

        <div class="days" id="daysGrid" role="grid" aria-label="days"></div>
      </section>

      <!-- RIGHT: tasks & notes -->
      <aside class="panel" aria-label="tasks and notes">
        <div>
          <h3>Tasks & Notes</h3>
          <div class="selected-info" id="selectedInfo">Pilih tanggal terlebih dahulu</div>

          <div class="add-row">
            <input id="taskInput" type="text" placeholder="Tambahkan tugas untuk tanggal ini..." aria-label="task input">
            <button id="addBtn" aria-label="add task">Tambah</button>
          </div>

          <div class="tasks-list" id="tasksList" aria-live="polite"></div>

          <div class="notes">
            <label style="display:block;font-weight:600;margin-bottom:6px;color:#5b3ea6">Catatan</label>
            <textarea id="notesArea" placeholder="catatan singkat untuk hari ini..."></textarea>
          </div>

          <div class="hint">Tulis task lalu klik teks untuk mengedit. Tekan Enter atau klik di luar untuk simpan.</div>
        </div>
      </aside>
    </main>
  </div>

  <!-- MEDAL POPUP -->
  <div id="medal-popup" role="dialog" aria-modal="true">
    <div class="medal">üèÖ</div>
    <h2>Yeay! Semua tugas selesai ‚ú®</h2>
    <p>Kamu menyelesaikan semua task untuk tanggal ini.</p>
    <button id="closeMedal">Tutup</button>
  </div>

<script>
/* ===================== Helpers & state ===================== */
const daysGrid = document.getElementById('daysGrid');
const monthLabel = document.getElementById('monthLabel');
const prevMonth = document.getElementById('prevMonth');
const nextMonth = document.getElementById('nextMonth');

const selectedInfo = document.getElementById('selectedInfo');
const taskInput = document.getElementById('taskInput');
const addBtn = document.getElementById('addBtn');
const tasksList = document.getElementById('tasksList');
const notesArea = document.getElementById('notesArea');

const medalPopup = document.getElementById('medal-popup');
const closeMedal = document.getElementById('closeMedal');

let viewDate = new Date(); // month/year view
let selectedDate = null;   // Date object for selected day

function toKey(dateObj){
  // format YYYY-MM-DD
  const y = dateObj.getFullYear();
  const m = String(dateObj.getMonth()+1).padStart(2,'0');
  const d = String(dateObj.getDate()).padStart(2,'0');
  return `${y}-${m}-${d}`;
}

function loadStorage(key){
  try{ return JSON.parse(localStorage.getItem(key)) || { tasks: [], notes: "" } } catch(e){ return {tasks:[], notes:""} }
}
function saveStorage(key, data){ localStorage.setItem(key, JSON.stringify(data)); }

/* ===================== Render calendar ===================== */
function renderCalendar(){
  daysGrid.innerHTML = '';
  const year = viewDate.getFullYear();
  const month = viewDate.getMonth();
  monthLabel.textContent = viewDate.toLocaleDateString('id-ID',{month:'long', year:'numeric'});

  // first day index (0=Sun)
  const first = new Date(year, month, 1).getDay();
  const daysInMonth = new Date(year, month+1, 0).getDate();

  // previous month spill (optional: create empty placeholders)
  for(let i=0;i<first;i++){
    const el = document.createElement('div'); el.className='day empty'; daysGrid.appendChild(el);
  }

  for(let d=1; d<=daysInMonth; d++){
    const el = document.createElement('div');
    el.className = 'day';
    el.setAttribute('role','button');
    el.tabIndex = 0;
    el.innerHTML = `<span class="date-num">${d}</span>`;

    const thisDate = new Date(year, month, d);
    // show dot if there are tasks or notes
    const key = toKey(thisDate);
    const data = loadStorage(key);
    if((data.tasks && data.tasks.length>0) || (data.notes && data.notes.trim().length>0)){
      const dot = document.createElement('div'); dot.className='dot';
      el.appendChild(dot);
    }

    // highlight today if matches current day
    const today = new Date();
    if(d === today.getDate() && month===today.getMonth() && year===today.getFullYear()){
      el.classList.add('today');
    }

    // click -> select date
    el.addEventListener('click', ()=> selectDate(thisDate, el));
    el.addEventListener('keydown', (e)=>{ if(e.key==='Enter') selectDate(thisDate, el) });

    daysGrid.appendChild(el);
  }

  // if a selectedDate exists but view changed, try reselect its element visually
  if(selectedDate && selectedDate.getMonth()===viewDate.getMonth() && selectedDate.getFullYear()===viewDate.getFullYear()){
    // find nth child: need to compute index including first blanks
    highlightSelected();
  } else {
    // clear selected info if selectedDate not in view
    // we still keep selectedDate value, tasks area will show for whatever date selected previously
  }
}

/* ===================== Select date & load tasks/notes ===================== */
function highlightSelected(){
  // remove existing selected class
  document.querySelectorAll('.day.selected').forEach(el=>el.classList.remove('selected'));
  if(!selectedDate) return;
  // compute position: count blanks = number of .day.empty
  const blanks = document.querySelectorAll('.day.empty').length;
  // find day element for selectedDate if month matches
  const elems = Array.from(daysGrid.querySelectorAll('.day')).filter(el=>!el.classList.contains('empty'));
  const idx = selectedDate.getDate()-1;
  const target = elems[idx];
  if(target) target.classList.add('selected');
}

function selectDate(dateObj, element=null){
  selectedDate = new Date(dateObj.getFullYear(), dateObj.getMonth(), dateObj.getDate());
  highlightSelected();
  loadDay(selectedDate);
}

function loadDay(dateObj){
  const key = toKey(dateObj);
  const data = loadStorage(key);
  // header info
  selectedInfo.textContent = dateObj.toLocaleDateString('id-ID', { weekday:'long', day:'numeric', month:'long', year:'numeric' });

  // tasks
  renderTasks(data.tasks || []);

  // notes
  notesArea.value = data.notes || '';
  // attach auto-save for notes
  notesArea.oninput = ()=> {
    const cur = loadStorage(key); cur.notes = notesArea.value; saveStorage(key, cur);
    // update calendar dot presence
    renderCalendar();
  };
}

/* ===================== Tasks: render/add/edit/delete/toggle ===================== */
function renderTasks(tasks){
  tasksList.innerHTML = '';
  tasks.forEach((task, idx)=>{
    const li = document.createElement('div');
    li.className = 'task-item'+(task.completed? ' completed':'');
    // checkbox
    const chk = document.createElement('input'); chk.type='checkbox'; chk.checked = !!task.completed;
    chk.setAttribute('aria-label','toggle task');
    chk.addEventListener('change', ()=>{
      toggleTask(idx);
    });

    // text (editable)
    const span = document.createElement('div');
    span.className = 'text';
    span.textContent = task.text;
    span.contentEditable = true;
    span.addEventListener('keydown', (e)=>{
      if(e.key==='Enter'){ e.preventDefault(); span.blur(); }
    });
    span.addEventListener('blur', ()=>{
      editTask(idx, span.textContent.trim());
    });

    // actions
    const actions = document.createElement('div'); actions.className='task-actions';
    const del = document.createElement('button'); del.className='icon-btn delete-btn'; del.title='Hapus task'; del.innerHTML='üóë';
    del.addEventListener('click', ()=> deleteTask(idx));

    actions.appendChild(del);
    li.appendChild(chk);
    li.appendChild(span);
    li.appendChild(actions);

    tasksList.appendChild(li);
  });
}

function ensureSelected(){
  if(!selectedDate){ alert('Pilih tanggal dulu di kalender.'); return false; } return true;
}

addBtn.addEventListener('click', ()=>{
  if(!ensureSelected()) return;
  const text = taskInput.value.trim();
  if(!text) return;
  const key = toKey(selectedDate);
  const data = loadStorage(key);
  data.tasks = data.tasks || [];
  data.tasks.push({ text, completed:false });
  saveStorage(key, data);
  taskInput.value = '';
  loadDay(selectedDate);
  renderCalendar(); // update dot
});

function toggleTask(index){
  if(!ensureSelected()) return;
  const key = toKey(selectedDate);
  const data = loadStorage(key);
  data.tasks[index].completed = !data.tasks[index].completed;
  saveStorage(key, data);
  loadDay(selectedDate);
  renderCalendar();
  // check award
  checkAward(key);
}

function editTask(index, newText){
  if(!ensureSelected()) return;
  const key = toKey(selectedDate);
  const data = loadStorage(key);
  data.tasks[index].text = newText || "(kosong)";
  saveStorage(key, data);
  renderCalendar();
  checkAward(key);
}

function deleteTask(index){
  if(!ensureSelected()) return;
  const key = toKey(selectedDate);
  const data = loadStorage(key);
  data.tasks.splice(index,1);
  saveStorage(key, data);
  loadDay(selectedDate);
  renderCalendar();
}

/* ===================== Award: medal + confetti when all tasks completed ===================== */
function checkAward(key){
  const data = loadStorage(key);
  if(!data.tasks || data.tasks.length===0) return;
  const all = data.tasks.every(t=>t.completed);
  if(all){
    showMedal();
    launchConfetti();
  }
}

function showMedal(){
  medalPopup.style.display = 'block';
  setTimeout(()=>{ medalPopup.style.transform='translate(-50%,-50%) scale(1)'; },10);
}
closeMedal.addEventListener('click', ()=>{
  medalPopup.style.display='none';
});

/* ===================== Confetti simple (no libraries) ===================== */
function launchConfetti(){
  const colors = ['#FFD1DC','#A7C7E7','#FFF5BA','#C8E6C9','#E1BEE7','#D7F0FF'];
  const count = 30;
  for(let i=0;i<count;i++){
    const el = document.createElement('div');
    el.className='confetti-piece';
    const size = Math.floor(Math.random()*10)+6;
    el.style.width = size+'px'; el.style.height = (size*0.6)+'px';
    el.style.left = Math.random()*100 + '%';
    el.style.top = '-10%';
    el.style.background = colors[Math.floor(Math.random()*colors.length)];
    el.style.opacity = Math.random()*0.9+0.3;
    el.style.transform = `rotate(${Math.random()*360}deg)`;
    document.body.appendChild(el);
    // animate using Web Animations
    const dx = (Math.random()-0.5)*200;
    const dy = window.innerHeight + 200 + Math.random()*200;
    const duration = 1200 + Math.random()*1000;
    el.animate([
      { transform: `translate3d(0,0,0) rotate(${Math.random()*360}deg)`, opacity:1 },
      { transform: `translate3d(${dx}px, ${dy}px, 0) rotate(${Math.random()*720}deg)`, opacity:0.3 }
    ], { duration, easing: 'cubic-bezier(.2,.8,.2,1)' });
    // remove after animation
    setTimeout(()=> el.remove(), duration+50);
  }
}

/* ===================== Month nav ===================== */
prevMonth.addEventListener('click', ()=>{
  viewDate.setMonth(viewDate.getMonth()-1);
  renderCalendar();
});
nextMonth.addEventListener('click', ()=>{
  viewDate.setMonth(viewDate.getMonth()+1);
  renderCalendar();
});

/* ===================== init ===================== */
renderCalendar();

// If user clicks outside any selected day (on blank), keep selection but allow UI
// allow keyboard shortcuts: Today = 't'
document.addEventListener('keydown', (e)=>{
  if(e.key.toLowerCase()==='t'){
    viewDate = new Date();
    renderCalendar();
  }
});

// If user reloads and had selected date stored in session, try to restore (optional)
const lastKey = sessionStorage.getItem('planner_last_selected');
if(lastKey){
  const parts = lastKey.split('-');
  if(parts.length===3){
    const d = new Date(parts[0], parseInt(parts[1],10)-1, parts[2]);
    selectedDate = d;
    // ensure view is on that month
    viewDate = new Date(d.getFullYear(), d.getMonth(), 1);
    renderCalendar();
    loadDay(selectedDate);
  }
}

// store selection to session when user selects date
function persistSelection(){
  if(selectedDate) sessionStorage.setItem('planner_last_selected', toKey(selectedDate));
}
document.addEventListener('click', persistSelection);
</script>
</body>
</html>
